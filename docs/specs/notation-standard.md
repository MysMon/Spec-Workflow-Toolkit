# 表記基準書

このプロジェクト全体のマークダウンファイルに適用する統一表記基準。
CLAUDE.md のルール階層（L1/L2/L3）定義に基づき、全ファイルで一貫性を確保する。

---

## A. L1/L2/L3 マーカーの表記規則

### 問題の背景

CLAUDE.md では L1/L2/L3 を以下のキーワードで定義している:
- L1: `NEVER`, `ALWAYS`, `MUST`
- L2: `should`, `by default`
- L3: `consider`, `prefer`, `recommend`

現状、ファイルによって以下の表記揺れが存在する:

| パターン | 使用箇所例 |
|---------|-----------|
| `- MUST: 内容` | CLAUDE.md |
| `- **必ず** 内容` | code-architect.md, code-explorer.md |
| `- 必ず 内容` | backend-specialist.md |
| `- ALWAYS 内容` | debug.md |
| `- NEVER: 内容` | CLAUDE.md, discussion-protocol |
| `- **絶対に** 内容` | security-auditor.md, qa-engineer.md |
| `- 絶対に 内容` | backend-specialist.md |
| マーカーなし平文 | 一部の L2 ルール |

### 統一基準

#### L1 ルール項目の形式

```
- MUST: 日本語でルール内容を記述
- NEVER: 日本語で禁止事項を記述
- ALWAYS: 日本語で必須事項を記述
```

**根拠:**
- CLAUDE.md 自身がこの形式を使用しており、プロジェクトの正規形式である
- 英語キーワードをプレフィックスとして保持することで、L1 マーカーが機械的に検索可能
- `**必ず**` や `絶対に` への翻訳はキーワードが日本語本文に溶け込み、検索性・識別性が低下する
- コロン `:` の後にスペースを入れて本文と区切る

**変換対応表:**

| 現在の表記 | 統一後 |
|-----------|--------|
| `**必ず** 内容` | `MUST: 内容` |
| `必ず 内容` | `MUST: 内容` |
| `MUST 内容`（コロンなし） | `MUST: 内容` |
| `**絶対に** 内容しない` | `NEVER: 内容しない` |
| `絶対に 内容しない` | `NEVER: 内容しない` |
| `NEVER 内容`（コロンなし） | `NEVER: 内容` |
| `ALWAYS 内容`（コロンなし） | `ALWAYS: 内容` |

#### L2 ルール項目の形式

```
- 日本語でルール内容を記述（マーカーなし平文）
```

**根拠:**
- CLAUDE.md の L2 セクションがマーカーなし平文を使用している
- L2 は「デフォルト動作」であり、特別なマーカーは不要
- `should` や `by default` は英語コンテキストで使用する際のキーワードであり、日本語ファイルではセクション見出し（`## デフォルト（L2 - ソフト）`）で L2 であることが明示される

#### L3 ルール項目の形式

```
- consider: 日本語で推奨事項を記述
- prefer: 日本語で優先事項を記述
- recommend: 日本語で推奨事項を記述
```

**根拠:**
- CLAUDE.md 自身がこの形式（`consider:`, `prefer:`）を使用している
- L1 と同様に英語キーワードをプレフィックスとして保持し、検索性を確保
- `consider` と `prefer` の使い分け:
  - `consider`: 検討を推奨（やるかどうかの判断は状況次第）
  - `prefer`: 特定の方法を優先（代替手段があるが、こちらが望ましい）
  - `recommend`: 一般的な推奨（`consider` と同義だが、より強い推奨ニュアンス）

---

## B. セクション見出しの統一形式

### 問題の背景

L1/L2/L3 セクションの見出しに以下の揺れがある:

| パターン | 使用箇所例 |
|---------|-----------|
| `## ルール（L1 - ハード）` | CLAUDE.md, spec-plan.md, review-response.md |
| `## ルール (L1 - ハード)` | code-architect.md, security-auditor.md |
| `## ルール` | backend-specialist.md, ui-ux-designer.md |
| `## Rules (L1 - Hard)` | debug.md, discuss.md, doc-audit.md |
| `## Rules (L1)` | plan-self-review |
| `### L1 ハードルール（MUST - 絶対に破らない）` | language-enforcement |
| `### L1 - ハードルール（絶対に破らない）` | bounded-autonomy |
| `### L1 (Hard Rules)` | insight-recording |
| `### ルール（L1 - ハード）` | subagent-contract（ネスト時） |

### 統一基準

#### トップレベルセクション（`##`）の形式

**日本語ファイルの場合:**

```markdown
## ルール（L1 - ハード）
## デフォルト（L2 - ソフト）
## ガイドライン（L3）
```

**英語ファイルの場合:**

```markdown
## Rules (L1 - Hard)
## Defaults (L2 - Soft)
## Guidelines (L3)
```

**根拠:**
- CLAUDE.md がこの形式を使用しており、プロジェクトの正規形式である
- 括弧は全角 `（）` を使用（日本語ファイル）/ 半角 `()` を使用（英語ファイル）
- L レベル番号とラベル（ハード/ソフト）の両方を含めることで、意味が一目で明確

#### ネストされたセクション（`###`）の形式

コンテキスト内にサブセクションとして L1/L2/L3 を配置する場合:

```markdown
### ルール（L1 - ハード）
### デフォルト（L2 - ソフト）
### ガイドライン（L3）
```

トップレベルと同じラベル形式を `###` で使用する。

#### 「ルール」のみ（L 表記なし）の扱い

一部のエージェントファイル（backend-specialist, ui-ux-designer, legacy-modernizer 等）で `## ルール` とだけ記載されているケースがある。

**基準:** L1/L2/L3 を区別しているファイルは統一形式を使用する。区別していないファイル（全ルールが L1 相当）は `## ルール（L1 - ハード）` に統一する。

---

## C. 技術用語の標準訳語リスト

`language-enforcement` スキルの技術用語マッピングを基盤とし、本プロジェクト固有の用語を追加する。

### プロジェクト固有用語

| English | 標準訳語 | 注記 |
|---------|---------|------|
| orchestrator | オーケストレーター | 長音あり |
| subagent | サブエージェント | 長音あり |
| blueprint | ブループリント | |
| checkpoint | チェックポイント | |
| fallback | フォールバック | |
| build sequence | ビルドシーケンス | |
| trade-off | トレードオフ | |
| entry point | エントリーポイント | 長音あり |
| data flow | データフロー | |
| hard rule | ハードルール | |
| soft rule | ソフトルール | |
| guideline | ガイドライン | |
| evaluator-optimizer | エバリュエーター-オプティマイザー | |
| graceful degradation | グレースフルデグラデーション | |
| ground truth | グラウンドトゥルース | |
| hallucination | ハルシネーション | |
| context window | コンテキストウィンドウ | |
| context protection | コンテキスト保護 | |
| delegation | 委任 | カタカナ不使用 |
| aggregation | 集約 | カタカナ不使用 |
| confidence score | 信頼度スコア | |
| severity | 重大度 | |
| iteration / refinement loop | 改善ループ / 反復 | |
| quick lookup | クイックルックアップ | |
| trivial edit | TRIVIAL 編集 | 英語のまま大文字保持 |
| frontmatter | フロントマター | |
| permission mode | パーミッションモード | |

### `language-enforcement` スキルとの関係

`language-enforcement` SKILL.md の技術用語マッピング（specification=仕様書、architecture=アーキテクチャ 等）は引き続き有効。本リストは language-enforcement に含まれないプロジェクト固有用語を補完する。

### 用語選択の原則

1. **カタカナ vs 和語**: 技術コミュニティで広く使われているカタカナ語はそのまま使用。一般的な和語訳がある場合（delegation=委任、aggregation=集約）は和語を優先
2. **長音符**: JIS Z 8301 準拠。3音節以上の語末は長音符を付ける（オーケストレーター、エントリーポイント）。2音節の語末は付けない（サーバ/サーバー は文脈に応じる）
3. **英語併記**: 初出時や曖昧な場合は `日本語（English）` の形式で併記可

---

## D. フォーマット規約

### リストマーカー

| コンテキスト | マーカー | 例 |
|------------|---------|-----|
| L1/L2/L3 ルール項目 | ハイフン `-` | `- MUST: 内容` |
| 手順・順序付きリスト | 数字 `1.` | `1. フェーズ 1 を実行` |
| ネストされた箇条書き | ハイフン `-`（2スペースインデント） | `  - サブ項目` |

**禁止:** アスタリスク `*` をリストマーカーとして使用しない。太字マーカー `**` との混同を防ぐ。

### 括弧の使い分け

| 用途 | 括弧 | 例 |
|------|------|-----|
| 日本語文中の補足 | 全角 `（）` | `ルール（L1 - ハード）` |
| 英語文中の補足 | 半角 `()` | `Rules (L1 - Hard)` |
| コード・技術用語の括弧 | 半角 `()` | `exit(0)` |
| 英語併記 | 全角 `（）` | `委任（delegation）` |

### コードブロック

| 項目 | 基準 |
|------|------|
| 言語指定 | 可能な限り指定する（`bash`, `json`, `markdown`, `typescript` 等） |
| インラインコード | 技術用語・ファイルパス・コマンドに使用（`` `file:line` ``, `` `npm test` ``） |
| ブロックコード | 複数行のコード・設定・テンプレートに使用 |

### 太字の使い方

| 用途 | 形式 | 例 |
|------|------|-----|
| セクション内の強調 | `**テキスト**` | `**重要:** 検証は必須` |
| テーブルヘッダーの強調項目 | `**テキスト**` | `**必須変更**` |
| L1 マーカーの強調 | 不使用 | `MUST:` をそのまま使用（`**MUST:**` にしない） |

**禁止:** L1 キーワード自体を太字にしない。`MUST:` / `NEVER:` / `ALWAYS:` は大文字のみで十分に目立つ。

### 水平線

| 用途 | 形式 |
|------|------|
| 主要セクション区切り | `---`（前後に空行） |
| フェーズ間の区切り | `---`（前後に空行） |

### テーブル

| 項目 | 基準 |
|------|------|
| ヘッダー行 | 必須 |
| 区切り行 | `|---|---|` 形式 |
| セル内改行 | 避ける（セルは単一行） |
| 空セル | `-` または `N/A` |

---

## E. ファイル言語の判定基準

現状、同一ディレクトリ内で日本語ファイルと英語ファイルが混在している。

### 判定ルール

ファイルの主要言語は以下で判定する:

1. **本文の言語**: 説明文・手順が日本語か英語か
2. **見出しの言語**: `## ルール` か `## Rules` か

### 現状の分類

| カテゴリ | 日本語 | 英語 |
|---------|--------|------|
| CLAUDE.md | 日本語 | - |
| commands/ | 全ファイル | - |
| agents/ | 全ファイル | - |
| skills/core/ | 全ファイル | - |
| skills/detection/ | stack-detector | - |
| skills/workflows/ | - | 全ファイル |
| docs/ | DEVELOPMENT.md（混在） | - |

### 統一基準

**表記基準の適用:** 各ファイルの現在の主要言語に合わせて基準を適用する。

- 日本語ファイル: `## ルール（L1 - ハード）` + `- MUST: 日本語内容`
- 英語ファイル: `## Rules (L1 - Hard)` + `- MUST: English content`

**L1/L3 マーカーは言語に関わらず英語キーワードを使用:**
- `MUST:`, `NEVER:`, `ALWAYS:` は日本語ファイルでも英語のまま
- `consider:`, `prefer:`, `recommend:` は日本語ファイルでも英語のまま

---

## F. 表記揺れ判定チェックリスト

調査エージェントが各ファイルを検査する際に使用するチェックリスト:

### 見出し

- [ ] L1 セクション見出しが統一形式に従っているか
- [ ] L2 セクション見出しが統一形式に従っているか
- [ ] L3 セクション見出しが統一形式に従っているか
- [ ] 「ルール」のみ（L表記なし）のセクションがないか

### L1 マーカー

- [ ] L1 ルール項目が `MUST:` / `NEVER:` / `ALWAYS:` プレフィックスを使用しているか
- [ ] `**必ず**` / `**絶対に**` 等の日本語マーカーが残っていないか
- [ ] コロン `:` が付いているか（`MUST 内容` → `MUST: 内容`）
- [ ] L1 キーワードが太字 `**MUST:**` になっていないか（不要）

### L2 項目

- [ ] L2 項目がマーカーなし平文になっているか
- [ ] `should:` や `by default:` のプレフィックスが付いていないか

### L3 マーカー

- [ ] L3 項目が `consider:` / `prefer:` / `recommend:` プレフィックスを使用しているか
- [ ] `検討する` / `優先する` 等の日本語マーカーのみになっていないか

### 用語

- [ ] 標準訳語リストの用語と一致しているか
- [ ] 同一ファイル内で同じ概念に異なる訳語を使っていないか

### フォーマット

- [ ] リストマーカーがハイフン `-` を使用しているか（`*` ではない）
- [ ] 括弧が日本語/英語の文脈に応じて正しく使い分けられているか
- [ ] コードブロックに言語指定があるか
